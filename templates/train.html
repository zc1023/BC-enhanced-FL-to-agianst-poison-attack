<!doctype html>
<html class="x-admin-sm">
    <head>
        <meta charset="UTF-8">
        <title>Finance System</title>
        <meta name="renderer" content="webkit|ie-comp|ie-stand">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <meta http-equiv="Cache-Control" content="no-siteapp" />
        <link rel="stylesheet" href="static/css/font.css">
        <link rel="stylesheet" href="static/fontAlibaba/iconfont.css">
        <link rel="stylesheet" href="static/css/xadmin.css">
        <!-- <link rel="stylesheet" href="./css/theme5.css"> -->
        <script src="static/lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="static/js/xadmin.js"></script>
        {% if 0 == stop %}
        <meta http-equiv="refresh" content="2000;url={{ url_for('train') }}">
        {% endif %}
        <script>
            // 是否开启刷新记忆tab功能
            // var is_remember = false;
        </script>
    </head>
    <body class="index">
        <script>
            if(!window.name){
                     window.name = 'test';
                     window.location.reload();
            }
       </script>
        <!-- 顶部开始 -->
        <div class="container">
            <div class="logo">
                <a href="/home">金融风控联邦学习系统</a></div>
 
            <!-- <ul class="layui-nav left fast-add" lay-filter="">
                <li class="layui-nav-item">
                    <a href="javascript:;">+新增</a>
                    <dl class="layui-nav-child">
                        <dd>
                            <a onclick="xadmin.open('最大化','http://www.baidu.com','','',true)">
                                <i class="iconfont">&#xe6a2;</i>弹出最大化</a></dd>
                        <dd>
                            <a onclick="xadmin.open('弹出自动宽高','http://www.baidu.com')">
                                <i class="iconfont">&#xe6a8;</i>弹出自动宽高</a></dd>
                        <dd>
                            <a onclick="xadmin.open('弹出指定宽高','http://www.baidu.com',500,300)">
                                <i class="iconfont">&#xe6a8;</i>弹出指定宽高</a></dd>
                        <dd>
                            <a onclick="xadmin.add_tab('在tab打开','member-list.html')">
                                <i class="iconfont">&#xe6b8;</i>在tab打开</a></dd>
                        <dd>
                            <a onclick="xadmin.add_tab('在tab打开刷新','member-del.html',true)">
                                <i class="iconfont">&#xe6b8;</i>在tab打开刷新</a></dd>
                    </dl>
                </li>
            </ul> -->
            <ul class="layui-nav right" lay-filter="">
                <li class="layui-nav-item">
                    <a href="javascript:;">
                        <div class="lafitewu_circle">
                            <i class="iconfont">&#xe6ff;</i>
                        </div>
                        {{username}}
                    </a>
                    <!-- <dl class="layui-nav-child">
                        <dd>
                            <a onclick="xadmin.open('个人信息','http://www.baidu.com')">个人信息</a></dd>
                        <dd>
                            <a onclick="xadmin.open('切换帐号','http://www.baidu.com')">切换帐号</a></dd>
                        <dd>
                            <a href="./login.html">退出</a></dd>
                    </dl> -->
                </li>
                <li class="layui-nav-item lafitewu_exit to-index">
                    <a href="/logout"><i class="iconfont">&#xe704;</i>登出</a>
                </li>
            </ul>
        </div>
        <!-- 顶部结束 -->
        <!-- 中部开始 -->
        <!-- 左侧菜单开始 -->
        <div class="left-nav">
            <div id="side-nav">
                <ul id="nav">
                    <li>
                        <a  href="/create" >
                            <i class="iconfont left-nav-li" lay-tips="模型训练">&#xe702;</i>
                            <cite>创建房间</cite>
                        </a>
                    </li>                    
                    <li>
                        <a  href="/train" >
                            <i class="iconfont left-nav-li" lay-tips="模型训练">&#xe702;</i>
                            <cite>加入房间</cite>
                        </a>
                    </li>
                    <li>
                        <a  href="/myroom" >
                            <i class="iconfont left-nav-li" lay-tips="模型训练">&#xe702;</i>
                            <cite>我的房间</cite>
                        </a>
                    </li>                    
                    <li>
                        <a  href="/info" >
                            <i class="iconfont left-nav-li" lay-tips="个人信息">&#xe702;</i>
                            <cite>个人信息</cite>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- <div class="x-slide_left"></div> -->
        <!-- 左侧菜单结束 -->
        <!-- 右侧主体开始 -->
        <div class="page-content">
            <div class="layui-tab tab" lay-filter="xbs_tab" lay-allowclose="false">
                <ul class="layui-tab-title">
                    <li class="home">
                        <!-- <i class="layui-icon">&#xe68e;</i>我的桌面 -->
                        加入房间
                    </li>
                </ul>


                <div class="layui-tab-content">
                    <div class="layui-fluid">
                        <div class="layui-row layui-col-space15">
                            <div class="layui-col-md12">
                                <div class="layui-card">
                                    <div class="layui-card-body ">
                                        <form class="layui-form layui-col-space5" action="/train" method='POST' id="trainForm">
                                            <div class="layui-input-inline layui-show-xs-block">
                                                <input type="text" name="room_num" placeholder="房间号" autocomplete="off" class="layui-input" required></div>                                           
                                            <div class="layui-input-inline layui-show-xs-block">
                                                <input type="text" name="data_address" placeholder="数据地址" autocomplete="off" class="layui-input" required></div>
                                            <div class="layui-input-inline layui-show-xs-block">
                                                <input type="text" name="p_key" placeholder="区块链私钥" autocomplete="off" class="layui-input" required></div>                                            
                                            <div class="layui-input-inline lafite_search layui-show-xs-block">
                                                <button class="layui-btn" id="submitButton" lay-submit="">
                                                    加入房间</button>
                                            </div>
                                        </form>
                                        
                                    </div>
                         
                                    </div> 
                                    <!-- <div class="layui-card-body ">
                                        <div class="page">
                                            <div>
                                                <a class="prev" href="">&lt;&lt;</a>
                                                <a class="num" href="">1</a>
                                                <span class="current">2</span>
                                                <a class="num" href="">3</a>
                                                
                                                <a class="next" href="">&gt;&gt;</a></div>
                                        </div>
                                    </div> -->
                                </div>
                            </div>
                        </div>
                    </div>

                </div>


                <div id="tab_show"></div>


            </div>
        </div>
        <div class="page-content-bg"></div>

        <style id="theme_style">
                .custom-progress {
        margin-top: 20px;
        margin-bottom: 20px;
    }

.page-content {
    overflow-y: auto;  /* 只在Y轴上滚动 */
    height: 100vh;     /* 使高度等于视口高度 */
}
.layui-tab-content{
    overflow-y: auto;  /* 只在Y轴上滚动 */
    height: 100vh;     /* 使高度等于视口高度 */
}
.layui-table td, .layui-table th {
    font-size: 14px; 
    padding: 5px;
}
    .progress-label {
    text-align: center;
    color: #666;
    margin-bottom: 20px;
}
        </style>
        <!-- 右侧主体结束 -->
        <!-- 中部结束 -->
    </body>
</html>
<script>


layui.use(['laydate', 'form', 'upload'],
        function() {
            var $ = layui.jquery
            
            $(".layui-tab-title li").click(function() {
                console.log($(this));
            });
        });

// layui.use(['jquery'], function() {
//             var $ = layui.jquery;
            
//             $('#loadClient').click(function() {
//                 $.get("/join", function() {
//                 });
//             });
//         });

layui.use(['element', 'layer'], function(){
    var element = layui.element; // 将element初始化移到这里
    var layer = layui.layer;
        var progress = 0;

        function showsuccessMsg() {
        var Msg = "房间加入成功，房间号为:JXWh5F32nyRU6fZmekt7VY";
        
        layer.open({
            title: '创建成功',
            content: Msg
        });
    }
        var is_train = {{ stop|tojson|safe }};
        console.log(is_train)
        if(is_train){
            showsuccessMsg();  
    }
});

layui.use(['element', 'layer'], function(){
    var element = layui.element; // 将element初始化移到这里
    var layer = layui.layer;
        var progress = 0;

        function showsuccessMsg() {
        var Msg = "私钥和公钥不匹配";
        
        layer.open({
            title: '错误',
            content: Msg
        });
    }
        var is_train = {{ is_pkey_valid|tojson|safe }};
        console.log(is_train)
        if(!is_train){
            showsuccessMsg();  
    }
});


// layui.use('element', function(){
//     var element = layui.element;

//     // 示例数据
//     var data = [
//         {client: 'Client1', progress: 30},
//         {client: 'Client2', progress: 50},
//         //...
//     ];

//     // 动态生成卡片内容
//     var content = '';
//     data.forEach(function(item){
//         content += '<div class="layui-col-md4">' +
//                       '<div class="layui-card">' +
//                         '<div class="layui-card-header">' + item.client + '</div>' +
//                         '<div class="layui-card-body">' +
//                           '<div class="layui-progress"><div class="layui-progress-bar" lay-percent="' + item.progress + '%"></div></div>' +
//                         '</div>' +
//                       '</div>' +
//                    '</div>';
//     });

//     document.getElementById('clientsCards').innerHTML = content;
//     element.render('progress');
// });
layui.use(['form', 'layer'], function(){
    var form = layui.form;
    var layer = layui.layer;

    // 当表单提交时
    form.on('submit', function(data){
        var roomNum = data.field.room_num; // 获取房间号的值
        console.log(roomNum);
        // 假设固定的房间号为"123456"
        if(!roomNum.includes("JXWh5F32nyRU6fZmekt7VY")){
    // 如果房间号不包含指定的字符串，则弹出警告并阻止提交
    layer.alert('房间号不正确！');
    return false; // 阻止提交
}
    });
});


    </script>